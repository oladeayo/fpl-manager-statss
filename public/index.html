<script>
    window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
  </script>
  <script defer src="/_vercel/insights/script.js"></script>

  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>FPL Manager Stats</title>
      <script src="https://cdn.tailwindcss.com"></script>
      <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
      <link rel="icon" href="path/to/favicon.ico" type="image/x-icon">
  </head>
  <body class="bg-gray-100 min-h-screen">
  
      <!-- Main Container -->
      <div class="container mx-auto px-4 py-8">
          
          <!-- Header Section -->
          <div class="text-center mb-8">
              <h1 class="text-4xl font-bold text-gray-800 mb-4">Check Manager Stats</h1>
              <p class="text-gray-600 text-lg">View your FPL team stats with your Manager ID</p>
          </div>
  
          <!-- Input Section -->
          <div class="max-w-lg mx-auto mb-8">
              <div class="bg-white rounded-lg shadow p-6">
                  <input type="text" 
                         id="managerId" 
                         placeholder="Enter Manager ID" 
                         class="w-full px-4 py-3 border rounded-lg border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  <button onclick="analyzeManager()" 
                          class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg flex items-center justify-center gap-2 transition duration-200">
                      <i class="fas fa-search"></i> Analyze Stats
                  </button>
              </div>
          </div>
  
          <!-- Results Section -->
          <div id="results" class="max-w-4xl mx-auto space-y-6"></div>
  
          <!-- Share Button -->
          <div class="flex justify-center mt-8">
              <button onclick="shareApp()" 
                      class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg flex items-center gap-2 transition duration-200">
                  <i class="fas fa-share-alt"></i> Share
              </button>
          </div>
  
          <!-- Footer Section -->
          <div class="text-center mt-12">
              <p class="text-gray-600">Created by 
                  <a href="https://twitter.com/Oladeeayo" target="_blank" class="text-blue-500 font-medium hover:underline">
                      Oladeeayo
                  </a>
              </p>
          </div>
      </div>
  
      <script>
          async function analyzeManager() {
              const managerId = document.getElementById('managerId').value;
              const resultsDiv = document.getElementById('results');
  
              // Display loading spinner
              resultsDiv.innerHTML = `
                  <div class="flex justify-center items-center py-8">
                      <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
                  </div>
              `;
  
              try {
                  const response = await fetch(`/api/analyze-manager/${managerId}`);
                  const data = await response.json();
  
                  // Manager Information
                  let html = `
                      <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                          <h2 class="text-2xl font-bold text-gray-800 mb-4">Manager's Summary</h2>
                          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div class="space-y-2">
                                  <p class="text-gray-600"><strong>Name:</strong> ${data.managerInfo.name}</p>
                                  <p class="text-gray-600"><strong>Team Name:</strong> ${data.managerInfo.teamName}</p>
                                  <p class="text-gray-600"><strong>Total Points:</strong> ${data.managerInfo.managerPoints}</p>
                                  <p class="text-gray-600"><strong>Total Points Lost on Bench:</strong> ${data.managerInfo.totalPointsLostOnBench}</p>
                                  <p class="text-gray-600"><strong>Total Captain Points:</strong> ${data.managerInfo.totalCaptaincyPoints}</p>
                              </div>
                              <div class="space-y-2">
                                  <p class="text-gray-600"><strong>Chips Used:</strong> ${data.managerInfo.allChipsUsed}</p>
                                  <p class="text-gray-600"><strong>Point Difference to World No 1:</strong> ${data.managerInfo.pointDifference}</p>
                                  <p class="text-gray-600"><strong>Overall Rank:</strong> ${data.managerInfo.overallRanking}</p>
                                  <p class="text-gray-600"><strong>2023/2024 Rank:</strong> ${data.managerInfo.lastSeasonRank}</p>
                                  <p class="text-gray-600"><strong>2022/2023 Rank:</strong> ${data.managerInfo.seasonBeforeLastRank}</p>
                              </div>
                          </div>
                      </div>
                  `;
  
                  // Player Stats Table
                  html += `
                      <div class="bg-white rounded-lg shadow-lg p-6">
                          <h2 class="text-2xl font-bold text-gray-800 mb-4">Squad Performance</h2>
                          <div class="overflow-x-auto">
                              <table class="min-w-full bg-white border rounded-lg">
                                  <thead class="bg-gray-50">
                                      <tr>
                                          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Player Name</th>
                                          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Team</th>
                                          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Position</th>
                                          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Points</th>
                                          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Games</th>
                                          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Starts</th>
                                          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Captain Points</th>
                                      </tr>
                                  </thead>
                                  <tbody class="bg-white divide-y divide-gray-200">
                  `;
  
                  data.playerStats.forEach((player, index) => {
                      html += `
                          <tr class="${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">
                              <td class="px-6 py-4 text-sm font-medium text-gray-900">${player.name}</td>
                              <td class="px-6 py-4 text-sm text-gray-500">${player.team}</td>
                              <td class="px-6 py-4 text-sm text-gray-500">${player.position}</td>
                              <td class="px-6 py-4 text-sm text-gray-500">${player.totalPointsActive}</td>
                              <td class="px-6 py-4 text-sm text-gray-500">${player.gwInSquad}</td>
                              <td class="px-6 py-4 text-sm text-gray-500">${player.starts}</td>
                              <td class="px-6 py-4 text-sm text-gray-500">${player.cappedPoints}</td>
                          </tr>
                      `;
                  });
  
                  html += `</tbody></table></div></div>`;
                  resultsDiv.innerHTML = html;
              } catch (error) {
                  resultsDiv.innerHTML = `
                      <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-lg">
                          <div class="flex">
                              <i class="fas fa-exclamation-circle text-red-500 mr-2"></i>
                              <p class="text-red-700 font-medium">Error: ${error.message}</p>
                          </div>
                      </div>
                  `;
              }
          }
  
          function shareApp() {
              const shareText = "Check out my Fantasy Premier League Manager Stats!";
              const shareUrl = window.location.href;
  
              if (navigator.share) {
                  navigator.share({
                      title: document.title,
                      text: shareText,
                      url: shareUrl
                  });
              } else {
                  const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}`;
                  const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;
                  const linkedInUrl = `https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(shareUrl)}`;
  
                  window.open(twitterUrl, "_blank");
                  window.open(facebookUrl, "_blank");
                  window.open(linkedInUrl, "_blank");
              }
          }
      </script>
  </body>
  </html>
  